# Description: Open source multimedia framework, designed and developed for television broadcasting
# URL: http://www.mltframework.org/
# Maintainer: Tsaop, leeroy at cock dot li
# Depends on: libdv libsamplerate opencv sdl_image sox

name=mlt
version=6.16.0
release=1
source=(https://github.com/mltframework/$name/archive/v${version}/$name-$version.tar.gz
	mlt-opencv4.patch)

build() {
	cd $name-$version

	# Fix build witn opencv4
	patch -Np1 -i $SRC/mlt-opencv4.patch

	# Disable PulseAudio
	sed -i 's|-D__LINUX_PULSE__||' src/modules/rtaudio/Makefile 

	# Fix qmake executable name for it to be found by configure
	sed -i 's|qmake|qmake-qt5|' src/modules/qt/configure

	./configure --prefix=/usr \
	--sysconfdir=/etc \
	--qt-includedir=/usr/include/qt5 \
	--qt-libdir=/usr/lib \
	--enable-gpl \
	--enable-gpl3 \
	--disable-static \
	--enable-shared \
	--enable-opencv

	make
	make DESTDIR=$PKG install
}
