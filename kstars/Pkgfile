# Description: KStars is free, open source, cross-platform Astronomy Software
# URL: https://edu.kde.org/kstars
# Maintainer: Tsaop, leeroy at cock dot li
# Depends on: astrometry.net eigen knewstuff knotifyconfig kplotting libindi libraw stellarsolver xplanet

name=kstars
version=3.5.7
source=(http://download.kde.org/stable/$name/$name-$version.tar.xz
	6978d77d.patch
	stellarsolver2.diff)
release=2

build() {

    cd $name-$version
    patch -Np1 -i $SRC/6978d77d.patch
    patch -Np1 -i $SRC/stellarsolver2.diff

    cmake -Bbuild \
	-DCMAKE_INSTALL_PREFIX=/usr \
	-DBUILD_TESTING=OFF \
	-DCMAKE_BUILD_TYPE=Release \
	-DKAUTH_HELPER_INSTALL_DIR=/etc/dbus-1/system.d \
	-DKDE_INSTALL_LIBDIR=lib \
	-Wno-dev

    cmake --build build
    DESTDIR=$PKG cmake --install build

    rm -rf $PKG/usr/share/locale
    rm -rf $PKG/usr/share/doc
}
