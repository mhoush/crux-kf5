# Description: Data Model and Extraction System for Travel Reservation information
# URL: https://cgit.kde.org/kitinerary.git/
# Maintainer: Tsaop, leeroy at cock dot li
# Depends on: kcalendarcore kcontacts kmime kpkpass poppler zxing-cpp

name=kitinerary
version=20.04.3
release=3
source=(https://download.kde.org/stable/release-service/$version/src/$name-$version.tar.xz
	8bf24e23.patch
	0001-Fix-build-with-latest-Poppler.patch)

build() {
	cd $name-$version

	# fix build with zxing-cpp 1.1.0
	patch -Np1 -i $SRC/8bf24e23.patch
	# fix build with latest poppler
	patch -Np1 -i $SRC/0001-Fix-build-with-latest-Poppler.patch

	mkdir build; cd build

	cmake -DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_TESTING=OFF \
		-DKDE_INSTALL_LIBDIR=lib \
		-DKDE_INSTALL_CONFDIR=/etc \
		..

	make
	make DESTDIR=$PKG install

	rm -rf $PKG/usr/share/locale
}
